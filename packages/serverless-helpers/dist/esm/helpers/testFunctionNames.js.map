{"version":3,"file":"testFunctionNames.js","names":["MAX_AWS_LAMBDA_NAME_LENGTH","STAGE","getFunctionNames","config","Object","keys","functions","getFullFunctionName","functionName","service","testFunctionNames","functionNames","length","it","expect","toEqual","each","fullFunctionName","toBeLessThanOrEqual"],"sources":["../../../src/helpers/testFunctionNames.ts"],"sourcesContent":["import { AWS } from '@serverless/typescript';\n\nconst MAX_AWS_LAMBDA_NAME_LENGTH = 64;\nconst STAGE = 'production';\n\nconst getFunctionNames = (config: AWS): string[] => {\n  return Object.keys(config.functions ?? []);\n};\n\nconst getFullFunctionName = (config: AWS, functionName: string): string =>\n  `${config.service}-${STAGE}-${functionName}`;\n\n/**\n * Test that all the automatically generated function names will pass the 64 characters AWS limit\n *\n * In Swarmion, we use the `dev`, `staging`, `production` convention, so we test with the longest suffix\n *\n * @param config serverless configuration object\n */\nconst testFunctionNames = (config: AWS): void => {\n  const functionNames = getFunctionNames(config);\n  if (functionNames.length === 0) {\n    it('has no functions declared', () => {\n      expect(functionNames).toEqual([]);\n    });\n\n    return;\n  }\n\n  it.each(functionNames)(\n    `has function %s which generated name contains less than or equal to ${MAX_AWS_LAMBDA_NAME_LENGTH} chars`,\n    (functionName: string) => {\n      const fullFunctionName = getFullFunctionName(config, functionName);\n\n      expect(fullFunctionName.length).toBeLessThanOrEqual(\n        MAX_AWS_LAMBDA_NAME_LENGTH,\n      );\n    },\n  );\n};\n\nexport default testFunctionNames;\n"],"mappings":"AAEA,IAAMA,0BAA0B,GAAG,EAAE;AACrC,IAAMC,KAAK,GAAG,YAAY;AAE1B,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAgB,CAAIC,MAAW,EAAe;EAAA;EAClD,OAAOC,MAAM,CAACC,IAAI,sBAACF,MAAM,CAACG,SAAS,iEAAI,EAAE,CAAC;AAC5C,CAAC;AAED,IAAMC,mBAAmB,GAAG,SAAtBA,mBAAmB,CAAIJ,MAAW,EAAEK,YAAoB;EAAA,iBACzDL,MAAM,CAACM,OAAO,cAAIR,KAAK,cAAIO,YAAY;AAAA,CAAE;;AAE9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAME,iBAAiB,GAAG,SAApBA,iBAAiB,CAAIP,MAAW,EAAW;EAC/C,IAAMQ,aAAa,GAAGT,gBAAgB,CAACC,MAAM,CAAC;EAC9C,IAAIQ,aAAa,CAACC,MAAM,KAAK,CAAC,EAAE;IAC9BC,EAAE,CAAC,2BAA2B,EAAE,YAAM;MACpCC,MAAM,CAACH,aAAa,CAAC,CAACI,OAAO,CAAC,EAAE,CAAC;IACnC,CAAC,CAAC;IAEF;EACF;EAEAF,EAAE,CAACG,IAAI,CAACL,aAAa,CAAC,+EACmDX,0BAA0B,aACjG,UAACQ,YAAoB,EAAK;IACxB,IAAMS,gBAAgB,GAAGV,mBAAmB,CAACJ,MAAM,EAAEK,YAAY,CAAC;IAElEM,MAAM,CAACG,gBAAgB,CAACL,MAAM,CAAC,CAACM,mBAAmB,CACjDlB,0BAA0B,CAC3B;EACH,CAAC,CACF;AACH,CAAC;AAED,eAAeU,iBAAiB"}